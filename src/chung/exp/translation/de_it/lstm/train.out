------------ Configs ------------
building de vocab...
found previously built de vocab, loading...
there are 6702 tokens in de vocab
building it vocab...
found previously built it vocab, loading...
there are 7447 tokens in it vocab
building translation train de->it dataset...
found preprocessed train de->it dataset, loading...
taking 25000 subset of full data...
truncating all sequences to have max 50 tokens...
building de vocab...
found previously built de vocab, loading...
there are 6702 tokens in de vocab
building it vocab...
found previously built it vocab, loading...
there are 7447 tokens in it vocab
building translation valid de->it dataset...
found preprocessed valid de->it dataset, loading...
taking 5000 subset of full data...
truncating all sequences to have max 50 tokens...
model summary: 
=================================================================
                Kernel Shape     Output Shape   Params  Mult-Adds
Layer                                                            
0_src_embedding  [512, 6702]   [128, 50, 512]  3431424    3431424
1_enc                      -   [128, 50, 512]  4202496    4194304
2_tgt_embedding  [512, 7447]   [128, 50, 512]  3812864    3812864
3_dec                      -   [128, 50, 512]  4202496    4194304
4_mlp            [512, 7447]  [128, 50, 7447]  3820311    3812864
-----------------------------------------------------------------
                        Totals
Total params          19469591
Trainable params      19469591
Non-trainable params         0
Mult-Adds             19445760
=================================================================
rnn:  lstm
num layers: 2
embedding dim:  512
data:  iwslt_de_it
max seq tokens:  50
train subset:  25000
valid subset:  5000
optimizer:  sgd
learning rate:  0.1
momentum:  0.9
weight decay:  0.0001
gradient clipping:  1.0
loss criterion:  ce
continue training:  False
save directory:  ./exp/translation/de_it/lstm
log directory:  ./log/translation/de_it/lstm
starting epoch:  0
ending epoch:  100
steps per epoch:  196
cuda:  True
---------------------------------
calculating bleu for 20 examples...
[2021-09-26 06:22:47] epoch 0: train_loss: 6.9954758176998215, valid_loss: 6.350305914878845, train_nll: 0.12106276706234757, valid_nll: 0.06410245998569274, valid_bleu: 3.2443942754603e-156
calculating bleu for 20 examples...
[2021-09-26 06:26:49] epoch 1: train_loss: 6.1860155256427065, valid_loss: 6.038874983787537, train_nll: 0.06318553469029674, valid_nll: 0.054616749404507545, valid_bleu: 4.583675624212911e-156
calculating bleu for 20 examples...
[2021-09-26 06:30:49] epoch 2: train_loss: 5.932629023279462, valid_loss: 5.831468284130096, train_nll: 0.05608011548723493, valid_nll: 0.049305680417280374, valid_bleu: 0.016583173704359917
calculating bleu for 20 examples...
[2021-09-26 06:34:51] epoch 3: train_loss: 5.733558752098862, valid_loss: 5.673481047153473, train_nll: 0.05062117237947425, valid_nll: 0.04497623877948975, valid_bleu: 0.016178028422054264
calculating bleu for 20 examples...
[2021-09-26 06:38:51] epoch 4: train_loss: 5.567896806463903, valid_loss: 5.5664867758750916, train_nll: 0.045888417805542266, valid_nll: 0.04167478800863435, valid_bleu: 0.016178028422054264
calculating bleu for 20 examples...
[2021-09-26 06:42:50] epoch 5: train_loss: 5.426363421946156, valid_loss: 5.455734968185425, train_nll: 0.041697491585867746, valid_nll: 0.038677080907891785, valid_bleu: 0.015925177647011353
calculating bleu for 20 examples...
[2021-09-26 06:46:52] epoch 6: train_loss: 5.269905815319139, valid_loss: 5.339899897575378, train_nll: 0.03791129174680126, valid_nll: 0.036070920263626315, valid_bleu: 0.015925177647011353
calculating bleu for 20 examples...
[2021-09-26 06:50:51] epoch 7: train_loss: 5.145167764352292, valid_loss: 5.256933331489563, train_nll: 0.03451882776377153, valid_nll: 0.03356999809185641, valid_bleu: 4.157955408938248e-155
calculating bleu for 20 examples...
[2021-09-26 06:54:50] epoch 8: train_loss: 5.035939669122501, valid_loss: 5.186777114868164, train_nll: 0.03157066568802814, valid_nll: 0.031355872998243224, valid_bleu: 2.0565908381170625e-79
calculating bleu for 20 examples...
[2021-09-26 06:58:51] epoch 9: train_loss: 4.935810816531279, valid_loss: 5.129586458206177, train_nll: 0.02897781366776447, valid_nll: 0.03008392736378959, valid_bleu: 0.025036999336198573
saving at epoch 9...
calculating bleu for 20 examples...
[2021-09-26 07:02:50] epoch 10: train_loss: 4.843198379691766, valid_loss: 5.069310307502747, train_nll: 0.026694599182751712, valid_nll: 0.02823026027028137, valid_bleu: 0.02933471300595005
calculating bleu for 20 examples...
[2021-09-26 07:06:51] epoch 11: train_loss: 4.757606460123646, valid_loss: 5.020352721214294, train_nll: 0.02463704792256258, valid_nll: 0.026663022141855883, valid_bleu: 0.029798943928564414
calculating bleu for 20 examples...
[2021-09-26 07:10:49] epoch 12: train_loss: 4.68051540851593, valid_loss: 4.957520425319672, train_nll: 0.022840059910988322, valid_nll: 0.02552129213208928, valid_bleu: 0.02562298945559278
calculating bleu for 20 examples...
[2021-09-26 07:14:48] epoch 13: train_loss: 4.607950672811391, valid_loss: 4.929865837097168, train_nll: 0.02121139181083879, valid_nll: 0.024531091650781697, valid_bleu: 0.025036999336198573
calculating bleu for 20 examples...
[2021-09-26 07:18:48] epoch 14: train_loss: 4.538173062460763, valid_loss: 4.9218710064888, train_nll: 0.01974875287345266, valid_nll: 0.02384559336585996, valid_bleu: 0.025399004401225778
calculating bleu for 20 examples...
[2021-09-26 07:22:47] epoch 15: train_loss: 4.4737687232543015, valid_loss: 4.9029276967048645, train_nll: 0.01844982058778101, valid_nll: 0.023393010778504034, valid_bleu: 0.04026320359808527
calculating bleu for 20 examples...
[2021-09-26 07:26:46] epoch 16: train_loss: 4.410164358664532, valid_loss: 4.880872905254364, train_nll: 0.017281333527570487, valid_nll: 0.022524488978404887, valid_bleu: 0.03626294968288352
calculating bleu for 20 examples...
[2021-09-26 07:30:44] epoch 17: train_loss: 4.3487929446356635, valid_loss: 4.890222489833832, train_nll: 0.01620887207342654, valid_nll: 0.02253216286686128, valid_bleu: 0.036632684315324474
calculating bleu for 20 examples...
[2021-09-26 07:34:43] epoch 18: train_loss: 4.292023773096045, valid_loss: 4.860222637653351, train_nll: 0.01527727578064372, valid_nll: 0.021759777226303664, valid_bleu: 0.02154816624258
calculating bleu for 20 examples...
[2021-09-26 07:38:42] epoch 19: train_loss: 4.231480530330113, valid_loss: 4.845961272716522, train_nll: 0.014396916706318758, valid_nll: 0.021180525052968822, valid_bleu: 0.03626008253532007
saving at epoch 19...
calculating bleu for 20 examples...
[2021-09-26 07:42:43] epoch 20: train_loss: 4.173477506151005, valid_loss: 4.837647795677185, train_nll: 0.013568969139566227, valid_nll: 0.020334077451884376, valid_bleu: 0.03716666081921047
calculating bleu for 20 examples...
[2021-09-26 07:46:40] epoch 21: train_loss: 4.117785905088697, valid_loss: 4.860663890838623, train_nll: 0.012861283229905731, valid_nll: 0.02047538460698051, valid_bleu: 0.0399587111055109
calculating bleu for 20 examples...
[2021-09-26 07:50:40] epoch 22: train_loss: 4.058595680460638, valid_loss: 4.870597183704376, train_nll: 0.01219830443246024, valid_nll: 0.02013302893913096, valid_bleu: 0.032825842525742985
calculating bleu for 20 examples...
[2021-09-26 07:54:40] epoch 23: train_loss: 4.002192277081159, valid_loss: 4.874296128749847, train_nll: 0.011568360356391975, valid_nll: 0.01975121627034355, valid_bleu: 0.036227719471003436
calculating bleu for 20 examples...
[2021-09-26 07:58:39] epoch 24: train_loss: 3.9501915744372775, valid_loss: 4.893934369087219, train_nll: 0.011022048143659318, valid_nll: 0.020501094129179772, valid_bleu: 0.034999270931511214
calculating bleu for 20 examples...
[2021-09-26 08:02:38] epoch 25: train_loss: 3.8975971742552153, valid_loss: 4.879827439785004, train_nll: 0.010550266524334342, valid_nll: 0.02010376045379771, valid_bleu: 0.035476962063347585
calculating bleu for 20 examples...
[2021-09-26 08:06:36] epoch 26: train_loss: 3.8440712130799586, valid_loss: 4.895567238330841, train_nll: 0.010089963106427874, valid_nll: 0.019469321320982867, valid_bleu: 0.021109063654183073
calculating bleu for 20 examples...
[2021-09-26 08:10:35] epoch 27: train_loss: 3.793524538984104, valid_loss: 4.93587327003479, train_nll: 0.009671811364621532, valid_nll: 0.02146445117119971, valid_bleu: 0.044093417390519356
calculating bleu for 20 examples...
[2021-09-26 08:14:34] epoch 28: train_loss: 3.744231017268434, valid_loss: 4.946730434894562, train_nll: 0.00929169767885792, valid_nll: 0.02061312618841664, valid_bleu: 0.026210078894384918
calculating bleu for 20 examples...
[2021-09-26 08:18:32] epoch 29: train_loss: 3.695555031299591, valid_loss: 4.956193029880524, train_nll: 0.008929151767030054, valid_nll: 0.021285280406187712, valid_bleu: 0.005298866657656779
saving at epoch 29...
calculating bleu for 20 examples...
[2021-09-26 08:22:35] epoch 30: train_loss: 3.646930316273047, valid_loss: 4.988589882850647, train_nll: 0.008607675320858802, valid_nll: 0.022099269773633242, valid_bleu: 0.004685093573881757
calculating bleu for 20 examples...
[2021-09-26 08:26:35] epoch 31: train_loss: 3.6056258435152015, valid_loss: 5.085296332836151, train_nll: 0.008321924350939336, valid_nll: 0.02390588149029445, valid_bleu: 0.02462917206923746
calculating bleu for 20 examples...
[2021-09-26 08:30:32] epoch 32: train_loss: 3.559896038503063, valid_loss: 5.057274520397186, train_nll: 0.00806546413032376, valid_nll: 0.02280302230578337, valid_bleu: 0.04436546553418934
calculating bleu for 20 examples...
[2021-09-26 08:34:32] epoch 33: train_loss: 3.5185783882530366, valid_loss: 5.051500141620636, train_nll: 0.007807758353259971, valid_nll: 0.02171992800082191, valid_bleu: 0.041912895041422996
calculating bleu for 20 examples...
[2021-09-26 08:38:35] epoch 34: train_loss: 3.4766301111299165, valid_loss: 5.124419450759888, train_nll: 0.0075549162371529805, valid_nll: 0.024688794605415898, valid_bleu: 0.007100399824232784
calculating bleu for 20 examples...
[2021-09-26 08:42:35] epoch 35: train_loss: 3.4392979169378477, valid_loss: 5.16320925951004, train_nll: 0.007348028788663903, valid_nll: 0.027542670304751243, valid_bleu: 0.011120975984682844
calculating bleu for 20 examples...
[2021-09-26 08:46:35] epoch 36: train_loss: 3.4042167310812035, valid_loss: 5.1716965436935425, train_nll: 0.007153518776407047, valid_nll: 0.02606796068366665, valid_bleu: 0.021683597041237773
calculating bleu for 20 examples...
[2021-09-26 08:50:34] epoch 37: train_loss: 3.3674693995592544, valid_loss: 5.175567328929901, train_nll: 0.0069714578901018415, valid_nll: 0.025921450959841868, valid_bleu: 0.011345630952257116
calculating bleu for 20 examples...
[2021-09-26 08:54:35] epoch 38: train_loss: 3.3361144637574953, valid_loss: 5.243768870830536, train_nll: 0.0068064279112523916, valid_nll: 0.02761544291607787, valid_bleu: 0.02417844126742693
calculating bleu for 20 examples...
[2021-09-26 08:58:34] epoch 39: train_loss: 3.3002944527840126, valid_loss: 5.245019912719727, train_nll: 0.006637578001995476, valid_nll: 0.029659069958192077, valid_bleu: 0.010328554105709395
saving at epoch 39...
calculating bleu for 20 examples...
[2021-09-26 09:02:35] epoch 40: train_loss: 3.2699925838684547, valid_loss: 5.262712597846985, train_nll: 0.006481905864014917, valid_nll: 0.02858470586984499, valid_bleu: 0.021705815430452663
calculating bleu for 20 examples...
[2021-09-26 09:06:39] epoch 41: train_loss: 3.2388183182599595, valid_loss: 5.276626884937286, train_nll: 0.006347126151882872, valid_nll: 0.02893934898006106, valid_bleu: 0.037952386279129224
calculating bleu for 20 examples...
[2021-09-26 09:10:39] epoch 42: train_loss: 3.2105003558859533, valid_loss: 5.315314888954163, train_nll: 0.006238185524453922, valid_nll: 0.031017356690006374, valid_bleu: 0.011737732469275043
calculating bleu for 20 examples...
[2021-09-26 09:14:40] epoch 43: train_loss: 3.183966583135177, valid_loss: 5.341608107089996, train_nll: 0.006094683771107945, valid_nll: 0.031416688185002366, valid_bleu: 0.04742801619200537
calculating bleu for 20 examples...
[2021-09-26 09:18:38] epoch 44: train_loss: 3.1574150859093177, valid_loss: 5.396597445011139, train_nll: 0.0059943991976368185, valid_nll: 0.034795638517040886, valid_bleu: 0.015881076016027916
calculating bleu for 20 examples...
[2021-09-26 09:22:38] epoch 45: train_loss: 3.1313232536218605, valid_loss: 5.378185212612152, train_nll: 0.005888045427750568, valid_nll: 0.03408900947381808, valid_bleu: 0.029437218576748237
calculating bleu for 20 examples...
[2021-09-26 09:26:36] epoch 46: train_loss: 3.1100271319856447, valid_loss: 5.447512686252594, train_nll: 0.005800268836507992, valid_nll: 0.03900034363921165, valid_bleu: 0.031165103737030797
calculating bleu for 20 examples...
[2021-09-26 09:30:36] epoch 47: train_loss: 3.0865295213095996, valid_loss: 5.462038278579712, train_nll: 0.0057116283089774, valid_nll: 0.034805369719845394, valid_bleu: 0.032759700921714624
calculating bleu for 20 examples...
[2021-09-26 09:34:34] epoch 48: train_loss: 3.0664003126475277, valid_loss: 5.488454699516296, train_nll: 0.005627019533429827, valid_nll: 0.03621748176990492, valid_bleu: 0.037408216741061276
calculating bleu for 20 examples...
[2021-09-26 09:38:35] epoch 49: train_loss: 3.0443924568137346, valid_loss: 5.467824101448059, train_nll: 0.005559061445897939, valid_nll: 0.03893808443389348, valid_bleu: 0.039420555871858
saving at epoch 49...
calculating bleu for 923 examples...
calculating bleu for 20 examples...
[2021-09-26 10:24:13] epoch 50: train_loss: 3.0279717895449423, valid_loss: 5.52534407377243, train_nll: 0.0054773500855114995, valid_nll: 0.03839306092866644, valid_bleu: 0.04127289279178219
calculating bleu for 20 examples...
[2021-09-26 10:28:02] epoch 51: train_loss: 3.0098708077352874, valid_loss: 5.533988833427429, train_nll: 0.005423701720421712, valid_nll: 0.03706979184819058, valid_bleu: 0.03291348468223645
calculating bleu for 20 examples...
[2021-09-26 10:31:52] epoch 52: train_loss: 2.9941891042553648, valid_loss: 5.552127361297607, train_nll: 0.005367466382396465, valid_nll: 0.04373895560772644, valid_bleu: 0.019347249279840585
calculating bleu for 20 examples...
[2021-09-26 10:35:42] epoch 53: train_loss: 2.976611560704757, valid_loss: 5.544329881668091, train_nll: 0.00531218532328703, valid_nll: 0.03992104757571305, valid_bleu: 0.03793020764985221
calculating bleu for 20 examples...
[2021-09-26 10:39:32] epoch 54: train_loss: 2.9605525537412993, valid_loss: 5.573183536529541, train_nll: 0.005254682378185039, valid_nll: 0.04112025322771849, valid_bleu: 0.019342193938604417
calculating bleu for 20 examples...
[2021-09-26 10:43:21] epoch 55: train_loss: 2.949034975499523, valid_loss: 5.53825181722641, train_nll: 0.005206979928308604, valid_nll: 0.03683313696590638, valid_bleu: 0.04184302453900828
calculating bleu for 20 examples...
[2021-09-26 10:47:11] epoch 56: train_loss: 2.9314448942943496, valid_loss: 5.61421811580658, train_nll: 0.005145030777600347, valid_nll: 0.04617898932607381, valid_bleu: 0.01582111010078424
calculating bleu for 20 examples...
[2021-09-26 10:51:01] epoch 57: train_loss: 2.9188141360574837, valid_loss: 5.620711624622345, train_nll: 0.005118389842753508, valid_nll: 0.04447631389303242, valid_bleu: 0.0023345360696197218
calculating bleu for 20 examples...
[2021-09-26 10:54:50] epoch 58: train_loss: 2.906088756055248, valid_loss: 5.62362539768219, train_nll: 0.005087470541973504, valid_nll: 0.04227956088042519, valid_bleu: 0.02817947942490013
calculating bleu for 20 examples...
[2021-09-26 10:58:39] epoch 59: train_loss: 2.896844280009367, valid_loss: 5.610056757926941, train_nll: 0.005037174484875738, valid_nll: 0.04373367227192988, valid_bleu: 0.03604841736867305
saving at epoch 59...
calculating bleu for 20 examples...
[2021-09-26 11:02:29] epoch 60: train_loss: 2.8880770984961064, valid_loss: 5.660000205039978, train_nll: 0.005014490972246442, valid_nll: 0.04771752281313548, valid_bleu: 0.02102792839987158
calculating bleu for 20 examples...
[2021-09-26 11:06:17] epoch 61: train_loss: 2.8753790247197055, valid_loss: 5.671266496181488, train_nll: 0.0049911557544007595, valid_nll: 0.042823415042924404, valid_bleu: 0.034381341791568674
calculating bleu for 20 examples...
[2021-09-26 11:10:06] epoch 62: train_loss: 2.866960429415411, valid_loss: 5.663445889949799, train_nll: 0.00497770982859086, valid_nll: 0.04568771435528976, valid_bleu: 0.030582507690711146
calculating bleu for 20 examples...
[2021-09-26 11:13:55] epoch 63: train_loss: 2.8598533126772665, valid_loss: 5.701249897480011, train_nll: 0.004958680353748555, valid_nll: 0.05204099938344607, valid_bleu: 4.585513931301639e-79
calculating bleu for 20 examples...
[2021-09-26 11:17:45] epoch 64: train_loss: 2.8543716997516397, valid_loss: 5.706286430358887, train_nll: 0.00494435495372038, valid_nll: 0.04778177839731191, valid_bleu: 0.03789779075401552
calculating bleu for 20 examples...
[2021-09-26 11:21:43] epoch 65: train_loss: 2.8454757916684055, valid_loss: 5.716855108737946, train_nll: 0.004917785727831782, valid_nll: 0.044471811743435806, valid_bleu: 0.007483215071903994
calculating bleu for 20 examples...
[2021-09-26 11:25:47] epoch 66: train_loss: 2.8416709109228484, valid_loss: 5.657793402671814, train_nll: 0.004917351309328663, valid_nll: 0.04423098862786937, valid_bleu: 0.03140798703582306
calculating bleu for 20 examples...
[2021-09-26 11:29:34] epoch 67: train_loss: 2.836179814776596, valid_loss: 5.7340304255485535, train_nll: 0.004915046655304578, valid_nll: 0.052080134121240414, valid_bleu: 0.006370405230161804
calculating bleu for 20 examples...
[2021-09-26 11:33:21] epoch 68: train_loss: 2.829193522735518, valid_loss: 5.67781400680542, train_nll: 0.004892753423574019, valid_nll: 0.04390399255960414, valid_bleu: 0.04234601719282098
calculating bleu for 20 examples...
[2021-09-26 11:37:08] epoch 69: train_loss: 2.8256716789031517, valid_loss: 5.686327755451202, train_nll: 0.00488986840462198, valid_nll: 0.0438821628229267, valid_bleu: 0.04309100450153275
saving at epoch 69...
calculating bleu for 20 examples...
[2021-09-26 11:40:57] epoch 70: train_loss: 2.8237234390511805, valid_loss: 5.722387671470642, train_nll: 0.004897076046223543, valid_nll: 0.04647518267371665, valid_bleu: 0.01561092164039347
calculating bleu for 20 examples...
[2021-09-26 11:44:45] epoch 71: train_loss: 2.818434482934524, valid_loss: 5.6906004548072815, train_nll: 0.004904471674549336, valid_nll: 0.03756654423303513, valid_bleu: 0.03565535682961642
calculating bleu for 20 examples...
[2021-09-26 11:48:47] epoch 72: train_loss: 2.8188669657220644, valid_loss: 5.7348015904426575, train_nll: 0.004885268718174526, valid_nll: 0.04931903054407989, valid_bleu: 0.03548327933572833
calculating bleu for 20 examples...
[2021-09-26 11:52:50] epoch 73: train_loss: 2.816020745403913, valid_loss: 5.6662421226501465, train_nll: 0.004899098747182794, valid_nll: 0.043563679883296326, valid_bleu: 0.005300658717390603
calculating bleu for 20 examples...
[2021-09-26 11:56:52] epoch 74: train_loss: 2.815066932415476, valid_loss: 5.716573476791382, train_nll: 0.004898320039243114, valid_nll: 0.049189735180890246, valid_bleu: 0.006370405230161804
calculating bleu for 20 examples...
[2021-09-26 12:00:39] epoch 75: train_loss: 2.8140916276951224, valid_loss: 5.718953728675842, train_nll: 0.004914314583758918, valid_nll: 0.04156383838065821, valid_bleu: 0.02023452636206164
calculating bleu for 20 examples...
[2021-09-26 12:04:27] epoch 76: train_loss: 2.8149987106420555, valid_loss: 5.710951209068298, train_nll: 0.004935069889019017, valid_nll: 0.052561801624707014, valid_bleu: 0.016755831411065514
calculating bleu for 20 examples...
[2021-09-26 12:08:16] epoch 77: train_loss: 2.8136018465976327, valid_loss: 5.670576810836792, train_nll: 0.00493196797273597, valid_nll: 0.04435829553635696, valid_bleu: 0.03378380185035287
calculating bleu for 20 examples...
[2021-09-26 12:12:04] epoch 78: train_loss: 2.812607919683262, valid_loss: 5.68690413236618, train_nll: 0.004947372636552716, valid_nll: 0.04573666623272688, valid_bleu: 0.010594272545163827
calculating bleu for 20 examples...
[2021-09-26 12:15:53] epoch 79: train_loss: 2.810285301841035, valid_loss: 5.6807220578193665, train_nll: 0.004957073507503587, valid_nll: 0.047147127558163734, valid_bleu: 0.028872406095323138
saving at epoch 79...
calculating bleu for 20 examples...
[2021-09-26 12:19:42] epoch 80: train_loss: 2.8141919350137514, valid_loss: 5.709307909011841, train_nll: 0.004972755695265166, valid_nll: 0.04695776336202778, valid_bleu: 0.010246443615176123
calculating bleu for 20 examples...
[2021-09-26 12:23:30] epoch 81: train_loss: 2.81882943669144, valid_loss: 5.663635790348053, train_nll: 0.005016344082112215, valid_nll: 0.040082393014935, valid_bleu: 0.03796362671528637
calculating bleu for 20 examples...
[2021-09-26 12:27:17] epoch 82: train_loss: 2.8209726786126894, valid_loss: 5.715561211109161, train_nll: 0.005030668278129733, valid_nll: 0.043578624841873505, valid_bleu: 0.014866177589402858
calculating bleu for 20 examples...
[2021-09-26 12:31:02] epoch 83: train_loss: 2.822486645104934, valid_loss: 5.669826447963715, train_nll: 0.005046690015208965, valid_nll: 0.04384807437424584, valid_bleu: 0.028783588920840885
calculating bleu for 20 examples...
[2021-09-26 12:34:48] epoch 84: train_loss: 2.821069515481287, valid_loss: 5.742245376110077, train_nll: 0.005060499931646853, valid_nll: 0.0515547583282268, valid_bleu: 0.01020326768115087
calculating bleu for 20 examples...
[2021-09-26 12:38:33] epoch 85: train_loss: 2.8212108040342527, valid_loss: 5.685596764087677, train_nll: 0.0050834131746876, valid_nll: 0.047864136398494087, valid_bleu: 0.016360320486007086
calculating bleu for 20 examples...
[2021-09-26 12:42:16] epoch 86: train_loss: 2.827312659244148, valid_loss: 5.699058830738068, train_nll: 0.005108003840030007, valid_nll: 0.04534235733912613, valid_bleu: 0.029392602520315798
calculating bleu for 20 examples...
[2021-09-26 12:46:00] epoch 87: train_loss: 2.8285133814325136, valid_loss: 5.617512404918671, train_nll: 0.005133397516523089, valid_nll: 0.04203304326281874, valid_bleu: 0.007121665363918286
calculating bleu for 20 examples...
[2021-09-26 12:49:43] epoch 88: train_loss: 2.833913350591854, valid_loss: 5.618198394775391, train_nll: 0.005160333336032167, valid_nll: 0.04017689840855742, valid_bleu: 0.03465718596658762
calculating bleu for 20 examples...
[2021-09-26 12:53:26] epoch 89: train_loss: 2.836711113550225, valid_loss: 5.650756061077118, train_nll: 0.005191468373512735, valid_nll: 0.04935664477613914, valid_bleu: 0.04252218293095501
saving at epoch 89...
calculating bleu for 20 examples...
[2021-09-26 12:57:10] epoch 90: train_loss: 2.8387241825765495, valid_loss: 5.637951850891113, train_nll: 0.005208390464782715, valid_nll: 0.04253109198876603, valid_bleu: 0.029159817120572796
calculating bleu for 20 examples...
[2021-09-26 13:00:53] epoch 91: train_loss: 2.8437741873215656, valid_loss: 5.670503675937653, train_nll: 0.005249092042753387, valid_nll: 0.04421117480500209, valid_bleu: 0.01658918441781675
calculating bleu for 20 examples...
[2021-09-26 13:04:36] epoch 92: train_loss: 2.846377783892106, valid_loss: 5.644336462020874, train_nll: 0.0052655916817366906, valid_nll: 0.04395481208014278, valid_bleu: 0.015766042952742733
calculating bleu for 20 examples...
[2021-09-26 13:08:20] epoch 93: train_loss: 2.8451296322199764, valid_loss: 5.667224407196045, train_nll: 0.005288536915514161, valid_nll: 0.04077620488383113, valid_bleu: 0.03929131389802866
calculating bleu for 20 examples...
[2021-09-26 13:12:04] epoch 94: train_loss: 2.8542441190505516, valid_loss: 5.625068426132202, train_nll: 0.005324109725952149, valid_nll: 0.04259407809769548, valid_bleu: 0.021534752925964174
calculating bleu for 20 examples...
[2021-09-26 13:15:48] epoch 95: train_loss: 2.8603463026942038, valid_loss: 5.62582528591156, train_nll: 0.00534349191548873, valid_nll: 0.040609972697998695, valid_bleu: 0.019313764872540932
calculating bleu for 20 examples...
[2021-09-26 13:19:31] epoch 96: train_loss: 2.865041824019685, valid_loss: 5.594996094703674, train_nll: 0.0053954213097162, valid_nll: 0.03934665439325444, valid_bleu: 0.009473826754214425
calculating bleu for 20 examples...
[2021-09-26 13:23:15] epoch 97: train_loss: 2.870056435769918, valid_loss: 5.608331918716431, train_nll: 0.005416678457454759, valid_nll: 0.04035355420741987, valid_bleu: 0.03869441406138676
calculating bleu for 20 examples...
[2021-09-26 13:26:59] epoch 98: train_loss: 2.8708393257491442, valid_loss: 5.5729557275772095, train_nll: 0.005461275692375339, valid_nll: 0.03628805905096517, valid_bleu: 0.009846052248031863
calculating bleu for 20 examples...
[2021-09-26 13:30:42] epoch 99: train_loss: 2.8732370892349555, valid_loss: 5.559252500534058, train_nll: 0.00548135975506841, valid_nll: 0.03437468377955528, valid_bleu: 0.03650092077796655
saving at epoch 99...
calculating bleu for 923 examples...
