------------ Configs ------------
building en vocab...
found previously built en vocab, loading...
there are 6079 tokens in en vocab
building de vocab...
found previously built de vocab, loading...
there are 6624 tokens in de vocab
building translation train en->de dataset...
found preprocessed train en->de dataset, loading...
taking 25000 subset of full data...
truncating all sequences to have max 50 tokens...
building en vocab...
found previously built en vocab, loading...
there are 6079 tokens in en vocab
building de vocab...
found previously built de vocab, loading...
there are 6624 tokens in de vocab
building translation valid en->de dataset...
found preprocessed valid en->de dataset, loading...
taking 5000 subset of full data...
truncating all sequences to have max 50 tokens...
model summary: 
=================================================================
                Kernel Shape     Output Shape   Params  Mult-Adds
Layer                                                            
0_src_embedding  [512, 6079]   [128, 50, 512]  3112448    3112448
1_enc                      -   [128, 50, 512]  4202496    4194304
2_tgt_embedding  [512, 6624]   [128, 50, 512]  3391488    3391488
3_dec                      -   [128, 50, 512]  4202496    4194304
4_mlp            [512, 6624]  [128, 50, 6624]  3398112    3391488
-----------------------------------------------------------------
                        Totals
Total params          18307040
Trainable params      18307040
Non-trainable params         0
Mult-Adds             18284032
=================================================================
rnn:  lstm
num layers: 2
embedding dim:  512
data:  iwslt_en_de
max seq tokens:  50
train subset:  25000
valid subset:  5000
optimizer:  sgd
learning rate:  0.1
momentum:  0.9
weight decay:  0.0001
gradient clipping:  1.0
loss criterion:  ce
continue training:  False
save directory:  ./exp/translation/en_de/lstm
log directory:  ./log/translation/en_de/lstm
starting epoch:  0
ending epoch:  100
steps per epoch:  196
cuda:  True
---------------------------------
calculating bleu for 20 examples...
[2021-09-26 05:53:04] epoch 0: train_loss: 6.667741568721071, valid_loss: 5.923810209546771, train_nll: 0.10824485002409902, valid_nll: 0.05954358507153917, valid_bleu: 1.4672850470085494e-79
calculating bleu for 20 examples...
[2021-09-26 05:56:46] epoch 1: train_loss: 5.798924385284891, valid_loss: 5.626105036054339, train_nll: 0.054967093312788984, valid_nll: 0.05152517979056065, valid_bleu: 9.847999414312105e-156
calculating bleu for 20 examples...
[2021-09-26 06:00:12] epoch 2: train_loss: 5.545349254900096, valid_loss: 5.4221891675676614, train_nll: 0.04923540343614412, valid_nll: 0.04738687780723565, valid_bleu: 9.497350474888438e-79
calculating bleu for 20 examples...
[2021-09-26 06:03:43] epoch 3: train_loss: 5.33883395973517, valid_loss: 5.242399896894183, train_nll: 0.045243230918797325, valid_nll: 0.04427285745841305, valid_bleu: 9.825488351477207e-79
calculating bleu for 20 examples...
[2021-09-26 06:07:11] epoch 4: train_loss: 5.145218345583702, valid_loss: 5.103139468601772, train_nll: 0.041558637016452085, valid_nll: 0.04165488662340992, valid_bleu: 8.999890041565577e-79
calculating bleu for 20 examples...
[2021-09-26 06:10:38] epoch 5: train_loss: 4.968324724508792, valid_loss: 4.928439889635358, train_nll: 0.03821768113739636, valid_nll: 0.038815266377217064, valid_bleu: 0.022062422564614888
calculating bleu for 20 examples...
[2021-09-26 06:14:05] epoch 6: train_loss: 4.8236850743391075, valid_loss: 4.822491032736642, train_nll: 0.03517300916399275, valid_nll: 0.036216667807919725, valid_bleu: 8.429064292528807e-79
calculating bleu for 20 examples...
[2021-09-26 06:17:32] epoch 7: train_loss: 4.695374848891277, valid_loss: 4.733498573303223, train_nll: 0.032442121002820075, valid_nll: 0.03467671856719752, valid_bleu: 0.022062422564614888
calculating bleu for 20 examples...
[2021-09-26 06:21:00] epoch 8: train_loss: 4.584023242094079, valid_loss: 4.644442353929792, train_nll: 0.029998238306276008, valid_nll: 0.03288273180992995, valid_bleu: 0.007364106362062313
calculating bleu for 20 examples...
[2021-09-26 06:24:26] epoch 9: train_loss: 4.4800106943870075, valid_loss: 4.589190755571638, train_nll: 0.027761485287413304, valid_nll: 0.031184823312705043, valid_bleu: 7.638880007677557e-79
saving at epoch 9...
calculating bleu for 20 examples...
[2021-09-26 06:27:56] epoch 10: train_loss: 4.385271503000843, valid_loss: 4.545257159641811, train_nll: 0.025762855467504384, valid_nll: 0.029744373215627836, valid_bleu: 0.012209170817216262
calculating bleu for 20 examples...
[2021-09-26 06:31:32] epoch 11: train_loss: 4.296780900079376, valid_loss: 4.502298900059292, train_nll: 0.02392891121689154, valid_nll: 0.028571248251761907, valid_bleu: 0.012055386931882132
calculating bleu for 20 examples...
[2021-09-26 06:35:00] epoch 12: train_loss: 4.21294908377589, valid_loss: 4.467271600450788, train_nll: 0.022277652104982188, valid_nll: 0.027534051773455633, valid_bleu: 0.007408241708762184
calculating bleu for 20 examples...
[2021-09-26 06:38:30] epoch 13: train_loss: 4.132537446459946, valid_loss: 4.415208067212786, train_nll: 0.020749982816384495, valid_nll: 0.02632340632679051, valid_bleu: 0.016944210033773523
calculating bleu for 20 examples...
[2021-09-26 06:41:58] epoch 14: train_loss: 4.062990916018584, valid_loss: 4.3798089027404785, train_nll: 0.019432472059482845, valid_nll: 0.025634674097514586, valid_bleu: 0.02603020294242291
calculating bleu for 20 examples...
[2021-09-26 06:45:39] epoch 15: train_loss: 3.983673881511299, valid_loss: 4.352709225245884, train_nll: 0.018159063015373386, valid_nll: 0.02485924009059058, valid_bleu: 0.040915492182741486
calculating bleu for 20 examples...
[2021-09-26 06:49:06] epoch 16: train_loss: 3.9192323003496443, valid_loss: 4.356912817273821, train_nll: 0.017049086664939414, valid_nll: 0.02456716624093551, valid_bleu: 0.04504744021422795
calculating bleu for 20 examples...
[2021-09-26 06:52:33] epoch 17: train_loss: 3.8497603182889977, valid_loss: 4.353188378470285, train_nll: 0.015999336914257235, valid_nll: 0.02421433059010661, valid_bleu: 0.013823544972645832
calculating bleu for 20 examples...
[2021-09-26 06:56:00] epoch 18: train_loss: 3.781467261363049, valid_loss: 4.338393075125558, train_nll: 0.015040015884672986, valid_nll: 0.023507939868386254, valid_bleu: 0.045227480894870505
calculating bleu for 20 examples...
[2021-09-26 06:59:27] epoch 19: train_loss: 3.7173508515163345, valid_loss: 4.31697382245745, train_nll: 0.014165335025730674, valid_nll: 0.022956582329075527, valid_bleu: 0.05145387836154138
saving at epoch 19...
calculating bleu for 20 examples...
[2021-09-26 07:02:54] epoch 20: train_loss: 3.651162406619714, valid_loss: 4.327940055302212, train_nll: 0.01335055455028515, valid_nll: 0.022842957969535074, valid_bleu: 0.03921192789340403
calculating bleu for 20 examples...
[2021-09-26 07:06:26] epoch 21: train_loss: 3.5881457985663903, valid_loss: 4.35703842980521, train_nll: 0.012592901598871971, valid_nll: 0.02277357136859112, valid_bleu: 0.03414050576231696
calculating bleu for 20 examples...
[2021-09-26 07:09:56] epoch 22: train_loss: 3.5277533081113077, valid_loss: 4.368040493556431, train_nll: 0.01196191740094903, valid_nll: 0.022190163253444722, valid_bleu: 0.020845367515535097
calculating bleu for 20 examples...
[2021-09-26 07:13:26] epoch 23: train_loss: 3.4698417125915992, valid_loss: 4.337173189435687, train_nll: 0.011345933689104649, valid_nll: 0.022037003754385914, valid_bleu: 0.04400922602686051
calculating bleu for 20 examples...
[2021-09-26 07:16:55] epoch 24: train_loss: 3.4095672429824364, valid_loss: 4.368677820478167, train_nll: 0.010769483788937939, valid_nll: 0.022003383710117414, valid_bleu: 0.041067940183825445
calculating bleu for 20 examples...
[2021-09-26 07:20:25] epoch 25: train_loss: 3.3531943474497115, valid_loss: 4.42066410609654, train_nll: 0.010277814901674938, valid_nll: 0.02332308257759264, valid_bleu: 0.027059873732757266
calculating bleu for 20 examples...
[2021-09-26 07:23:53] epoch 26: train_loss: 3.2989311887293447, valid_loss: 4.401021071842739, train_nll: 0.009822899018891003, valid_nll: 0.02184471099511252, valid_bleu: 0.05033290110876777
calculating bleu for 20 examples...
[2021-09-26 07:27:22] epoch 27: train_loss: 3.2441595938740946, valid_loss: 4.429695129394531, train_nll: 0.009414046521868025, valid_nll: 0.022624227268157975, valid_bleu: 0.045564631951806885
calculating bleu for 20 examples...
[2021-09-26 07:30:50] epoch 28: train_loss: 3.1958056663980288, valid_loss: 4.462531498500279, train_nll: 0.009019628990329041, valid_nll: 0.02384584514199208, valid_bleu: 0.028871971037820455
calculating bleu for 20 examples...
[2021-09-26 07:34:19] epoch 29: train_loss: 3.1453090748008417, valid_loss: 4.49891015461513, train_nll: 0.008665570624215262, valid_nll: 0.024727471371436955, valid_bleu: 0.036965273691615105
saving at epoch 29...
calculating bleu for 20 examples...
[2021-09-26 07:37:48] epoch 30: train_loss: 3.098401216828093, valid_loss: 4.537964412144253, train_nll: 0.008343542858045928, valid_nll: 0.026248502652420236, valid_bleu: 0.03012856485911248
calculating bleu for 20 examples...
[2021-09-26 07:41:17] epoch 31: train_loss: 3.053973138332367, valid_loss: 4.5482989719935825, train_nll: 0.008051228457825401, valid_nll: 0.025536528578749648, valid_bleu: 0.02726987137986498
calculating bleu for 20 examples...
[2021-09-26 07:44:46] epoch 32: train_loss: 3.0082596309331, valid_loss: 4.584500994001116, train_nll: 0.007769967613063982, valid_nll: 0.02632363041132376, valid_bleu: 0.06840708297444209
calculating bleu for 20 examples...
[2021-09-26 07:48:15] epoch 33: train_loss: 2.9682063302215265, valid_loss: 4.615118571690151, train_nll: 0.007514418962626869, valid_nll: 0.02616634428512088, valid_bleu: 0.034583492332765475
calculating bleu for 20 examples...
[2021-09-26 07:51:43] epoch 34: train_loss: 2.927971102753464, valid_loss: 4.630410875592913, train_nll: 0.00728457343432368, valid_nll: 0.028076972828167374, valid_bleu: 0.0279016440641377
calculating bleu for 20 examples...
[2021-09-26 07:55:12] epoch 35: train_loss: 2.8884132321999996, valid_loss: 4.664497443607876, train_nll: 0.007050501057371802, valid_nll: 0.029295236622943095, valid_bleu: 0.015065202446392844
calculating bleu for 20 examples...
[2021-09-26 07:58:41] epoch 36: train_loss: 2.8499093700428397, valid_loss: 4.688499518803188, train_nll: 0.006869577434306242, valid_nll: 0.029437470685955706, valid_bleu: 0.048267519283254824
calculating bleu for 20 examples...
[2021-09-26 08:02:09] epoch 37: train_loss: 2.8196890889381874, valid_loss: 4.72029835837228, train_nll: 0.006677242153356325, valid_nll: 0.031227365358061247, valid_bleu: 0.03713927039521137
calculating bleu for 20 examples...
[2021-09-26 08:05:38] epoch 38: train_loss: 2.7839643578140105, valid_loss: 4.72909688949585, train_nll: 0.006488426948020512, valid_nll: 0.0311959356612023, valid_bleu: 0.06949948989230878
calculating bleu for 20 examples...
[2021-09-26 08:09:08] epoch 39: train_loss: 2.7498167692398536, valid_loss: 4.7618809427533835, train_nll: 0.0063077202069029515, valid_nll: 0.03221382930844688, valid_bleu: 0.05233596865753033
saving at epoch 39...
calculating bleu for 20 examples...
[2021-09-26 08:12:37] epoch 40: train_loss: 2.7209065532197756, valid_loss: 4.814008031572614, train_nll: 0.006174480246719049, valid_nll: 0.03299917826693732, valid_bleu: 0.03432131402010867
calculating bleu for 20 examples...
[2021-09-26 08:16:07] epoch 41: train_loss: 2.6929610627038136, valid_loss: 4.818957669394357, train_nll: 0.006031466797030702, valid_nll: 0.03537051128451275, valid_bleu: 0.041354796036662034
calculating bleu for 20 examples...
[2021-09-26 08:19:35] epoch 42: train_loss: 2.666190969700716, valid_loss: 4.860145092010498, train_nll: 0.005904621483939034, valid_nll: 0.03389827519967552, valid_bleu: 0.06897979799156899
calculating bleu for 20 examples...
[2021-09-26 08:23:04] epoch 43: train_loss: 2.643130443534073, valid_loss: 4.838405404772077, train_nll: 0.005775660749162946, valid_nll: 0.035245259602864586, valid_bleu: 0.03080323586990712
calculating bleu for 20 examples...
[2021-09-26 08:26:31] epoch 44: train_loss: 2.6143920847347806, valid_loss: 4.878448418208531, train_nll: 0.005636829450957629, valid_nll: 0.036864469191194744, valid_bleu: 0.04027210707417252
calculating bleu for 20 examples...
[2021-09-26 08:30:00] epoch 45: train_loss: 2.593397421496255, valid_loss: 4.873819010598319, train_nll: 0.005563728918022739, valid_nll: 0.03504106213358707, valid_bleu: 0.039259133679909304
calculating bleu for 20 examples...
[2021-09-26 08:33:29] epoch 46: train_loss: 2.567636947242581, valid_loss: 4.922539302280971, train_nll: 0.005440303840996097, valid_nll: 0.0350290804493184, valid_bleu: 0.028104565442196083
calculating bleu for 20 examples...
[2021-09-26 08:36:57] epoch 47: train_loss: 2.5490409111490053, valid_loss: 4.95497076851981, train_nll: 0.005339361211056486, valid_nll: 0.04123523134938889, valid_bleu: 0.06016360341278988
calculating bleu for 20 examples...
[2021-09-26 08:40:26] epoch 48: train_loss: 2.532154824052538, valid_loss: 4.97025557926723, train_nll: 0.005276377821163255, valid_nll: 0.03776028095349864, valid_bleu: 0.05579347821606599
calculating bleu for 20 examples...
[2021-09-26 08:43:55] epoch 49: train_loss: 2.5096055354390825, valid_loss: 5.0182158606393, train_nll: 0.0051766942917903895, valid_nll: 0.04201144930149926, valid_bleu: 0.03884917928117536
saving at epoch 49...
calculating bleu for 888 examples...
calculating bleu for 20 examples...
[2021-09-26 09:26:29] epoch 50: train_loss: 2.4942540939973323, valid_loss: 4.9969169071742465, train_nll: 0.005104304566675303, valid_nll: 0.040609043427832225, valid_bleu: 0.03464962129314693
calculating bleu for 20 examples...
[2021-09-26 09:29:57] epoch 51: train_loss: 2.475202531230693, valid_loss: 5.032885347093854, train_nll: 0.005022719216902651, valid_nll: 0.04194988567045801, valid_bleu: 0.012560564278077788
calculating bleu for 20 examples...
[2021-09-26 09:33:25] epoch 52: train_loss: 2.461585600765384, valid_loss: 5.086491584777832, train_nll: 0.0049631926478171835, valid_nll: 0.047667616801920304, valid_bleu: 0.050891092140259685
calculating bleu for 20 examples...
[2021-09-26 09:36:53] epoch 53: train_loss: 2.448229582942262, valid_loss: 5.076426914760044, train_nll: 0.004894347050725197, valid_nll: 0.04805362748407138, valid_bleu: 0.052953924840760044
calculating bleu for 20 examples...
[2021-09-26 09:40:22] epoch 54: train_loss: 2.433842957019806, valid_loss: 5.082160472869873, train_nll: 0.004836545573850612, valid_nll: 0.04508430682948723, valid_bleu: 0.023266501596874555
calculating bleu for 20 examples...
[2021-09-26 09:43:51] epoch 55: train_loss: 2.421249670641763, valid_loss: 5.12712744304112, train_nll: 0.004788776313145893, valid_nll: 0.04767179655708752, valid_bleu: 0.03634001940889474
calculating bleu for 20 examples...
[2021-09-26 09:47:23] epoch 56: train_loss: 2.4112768331352545, valid_loss: 5.1289511408124655, train_nll: 0.004748682477127616, valid_nll: 0.04661156075209856, valid_bleu: 0.0435967332361553
calculating bleu for 20 examples...
[2021-09-26 09:50:50] epoch 57: train_loss: 2.39509601617346, valid_loss: 5.120554855891636, train_nll: 0.004688564701087177, valid_nll: 0.04921481494935126, valid_bleu: 0.03336280703343138
calculating bleu for 20 examples...
[2021-09-26 09:54:18] epoch 58: train_loss: 2.382781121195579, valid_loss: 5.154325144631522, train_nll: 0.004638446957674861, valid_nll: 0.04781908742599922, valid_bleu: 0.031102585959935824
calculating bleu for 20 examples...
[2021-09-26 09:57:46] epoch 59: train_loss: 2.37544882419158, valid_loss: 5.132932322365897, train_nll: 0.004598547331362355, valid_nll: 0.045007154770163975, valid_bleu: 0.06815746756491547
saving at epoch 59...
calculating bleu for 20 examples...
[2021-09-26 10:01:16] epoch 60: train_loss: 2.3641612517590427, valid_loss: 5.132603372846331, train_nll: 0.004569684769309842, valid_nll: 0.04681654164054241, valid_bleu: 0.03213724127854907
calculating bleu for 20 examples...
[2021-09-26 10:04:40] epoch 61: train_loss: 2.359558536081898, valid_loss: 5.142771175929478, train_nll: 0.004521568535785286, valid_nll: 0.04798640107205519, valid_bleu: 0.04649958450040173
calculating bleu for 20 examples...
[2021-09-26 10:08:02] epoch 62: train_loss: 2.3492899561414915, valid_loss: 5.1362747464861185, train_nll: 0.00449242053284937, valid_nll: 0.04852021882410851, valid_bleu: 0.02777230454381292
calculating bleu for 20 examples...
[2021-09-26 10:11:25] epoch 63: train_loss: 2.3449938285107517, valid_loss: 5.1455623762948175, train_nll: 0.0044671888597728445, valid_nll: 0.048546077618157955, valid_bleu: 0.02815095696152728
calculating bleu for 20 examples...
[2021-09-26 10:14:48] epoch 64: train_loss: 2.3416781583610846, valid_loss: 5.18939208984375, train_nll: 0.004438562901287773, valid_nll: 0.04787762083098125, valid_bleu: 0.028947211035516885
calculating bleu for 20 examples...
[2021-09-26 10:18:11] epoch 65: train_loss: 2.331252562756441, valid_loss: 5.153214250292097, train_nll: 0.004432444654970753, valid_nll: 0.04537153270319556, valid_bleu: 0.029310885376188346
calculating bleu for 20 examples...
[2021-09-26 10:21:34] epoch 66: train_loss: 2.3292700137410844, valid_loss: 5.168695313589914, train_nll: 0.004403573885158617, valid_nll: 0.046457258737532175, valid_bleu: 0.029009201598517782
calculating bleu for 20 examples...
[2021-09-26 10:24:58] epoch 67: train_loss: 2.3257606394436894, valid_loss: 5.147126197814941, train_nll: 0.004398348208440392, valid_nll: 0.05015441437244503, valid_bleu: 0.031366364826914
calculating bleu for 20 examples...
[2021-09-26 10:28:20] epoch 68: train_loss: 2.3208343386650085, valid_loss: 5.166306223188128, train_nll: 0.004369674298811932, valid_nll: 0.04897550704571709, valid_bleu: 0.06660295271541625
calculating bleu for 20 examples...
[2021-09-26 10:31:42] epoch 69: train_loss: 2.316786224744758, valid_loss: 5.199248109545026, train_nll: 0.004346858413073481, valid_nll: 0.05430452199866829, valid_bleu: 0.029609938678764814
saving at epoch 69...
calculating bleu for 20 examples...
[2021-09-26 10:35:06] epoch 70: train_loss: 2.314390534040879, valid_loss: 5.190388270786831, train_nll: 0.00435572584580402, valid_nll: 0.055437329631229604, valid_bleu: 0.031721481168463905
calculating bleu for 20 examples...
[2021-09-26 10:38:28] epoch 71: train_loss: 2.3100138306617737, valid_loss: 5.180984837668283, train_nll: 0.004321073205130441, valid_nll: 0.05287599993181658, valid_bleu: 0.05537758663121799
calculating bleu for 20 examples...
[2021-09-26 10:41:55] epoch 72: train_loss: 2.311149865997081, valid_loss: 5.1889486994062155, train_nll: 0.004329010220154853, valid_nll: 0.05008242537506715, valid_bleu: 0.06694939124462974
calculating bleu for 20 examples...
[2021-09-26 10:45:21] epoch 73: train_loss: 2.305919879553269, valid_loss: 5.173323835645403, train_nll: 0.004317109926963339, valid_nll: 0.05138881856585539, valid_bleu: 0.05668921468635381
calculating bleu for 20 examples...
[2021-09-26 10:48:50] epoch 74: train_loss: 2.3015198707580566, valid_loss: 5.18719128199986, train_nll: 0.004306727095721423, valid_nll: 0.05106593519695806, valid_bleu: 0.039019970221582295
calculating bleu for 20 examples...
[2021-09-26 10:52:19] epoch 75: train_loss: 2.3042411037853787, valid_loss: 5.181467805589948, train_nll: 0.004306804578352948, valid_nll: 0.045351823784669856, valid_bleu: 0.04191133977330651
calculating bleu for 20 examples...
[2021-09-26 10:55:47] epoch 76: train_loss: 2.3002259354202117, valid_loss: 5.1996603693280905, train_nll: 0.004309124320672483, valid_nll: 0.05073539858728806, valid_bleu: 0.03000660738608759
calculating bleu for 20 examples...
[2021-09-26 10:59:15] epoch 77: train_loss: 2.3009471285099887, valid_loss: 5.1698431968688965, train_nll: 0.004302581876637984, valid_nll: 0.04789748510075615, valid_bleu: 0.029606533800705305
calculating bleu for 20 examples...
[2021-09-26 11:02:44] epoch 78: train_loss: 2.303253268708988, valid_loss: 5.147014004843576, train_nll: 0.004308551922233737, valid_nll: 0.044582649591456094, valid_bleu: 0.007755775045260048
calculating bleu for 20 examples...
[2021-09-26 11:06:11] epoch 79: train_loss: 2.3024111888846575, valid_loss: 5.149252755301339, train_nll: 0.0043163609275039365, valid_nll: 0.04895177056715317, valid_bleu: 0.030242743906412385
saving at epoch 79...
calculating bleu for 20 examples...
[2021-09-26 11:09:41] epoch 80: train_loss: 2.3021010063132463, valid_loss: 5.187263625008719, train_nll: 0.004322665048134726, valid_nll: 0.04924494818217352, valid_bleu: 0.06104841436936104
calculating bleu for 20 examples...
[2021-09-26 11:13:08] epoch 81: train_loss: 2.3042274908143647, valid_loss: 5.1381698335920065, train_nll: 0.004320660332826367, valid_nll: 0.049019241403143815, valid_bleu: 0.06400906219138394
calculating bleu for 20 examples...
[2021-09-26 11:16:35] epoch 82: train_loss: 2.302031340647717, valid_loss: 5.181695869990757, train_nll: 0.004327658699046161, valid_nll: 0.052430932630092526, valid_bleu: 0.021108635722647835
calculating bleu for 20 examples...
[2021-09-26 11:20:02] epoch 83: train_loss: 2.3059403032672647, valid_loss: 5.170473848070417, train_nll: 0.004337808368449309, valid_nll: 0.04929246672770407, valid_bleu: 0.019617711047123027
calculating bleu for 20 examples...
[2021-09-26 11:23:30] epoch 84: train_loss: 2.3068661397817185, valid_loss: 5.157701832907541, train_nll: 0.0043480288571727515, valid_nll: 0.05071383387009259, valid_bleu: 0.05875230272472086
calculating bleu for 20 examples...
[2021-09-26 11:26:58] epoch 85: train_loss: 2.3065426288818824, valid_loss: 5.141231945582798, train_nll: 0.004355457194245796, valid_nll: 0.04715187555289615, valid_bleu: 0.03202739905829618
calculating bleu for 20 examples...
[2021-09-26 11:30:25] epoch 86: train_loss: 2.308289029160324, valid_loss: 5.1605890819004605, train_nll: 0.0043656751041023095, valid_nll: 0.04896102501290053, valid_bleu: 0.031899123463582826
calculating bleu for 20 examples...
[2021-09-26 11:33:52] epoch 87: train_loss: 2.320076154202831, valid_loss: 5.104785646711077, train_nll: 0.0043905979218774914, valid_nll: 0.044829289512963916, valid_bleu: 0.06275538596369931
calculating bleu for 20 examples...
[2021-09-26 11:37:19] epoch 88: train_loss: 2.314126813898281, valid_loss: 5.127824442727225, train_nll: 0.004391142323168342, valid_nll: 0.04480240112237357, valid_bleu: 0.031888870662136914
calculating bleu for 20 examples...
[2021-09-26 11:40:46] epoch 89: train_loss: 2.315336654380876, valid_loss: 5.171634333474295, train_nll: 0.0044030616797152, valid_nll: 0.049530046830876036, valid_bleu: 0.021661941586411472
saving at epoch 89...
calculating bleu for 20 examples...
[2021-09-26 11:44:14] epoch 90: train_loss: 2.3200727251111246, valid_loss: 5.1538077763148715, train_nll: 0.004426276431180993, valid_nll: 0.05123297110443761, valid_bleu: 0.03782879720119536
calculating bleu for 20 examples...
[2021-09-26 11:47:42] epoch 91: train_loss: 2.324362034700355, valid_loss: 5.142660617828369, train_nll: 0.004451608377241824, valid_nll: 0.04887395291715055, valid_bleu: 0.07700067703475962
calculating bleu for 20 examples...
[2021-09-26 11:51:09] epoch 92: train_loss: 2.3270902037620544, valid_loss: 5.118122850145612, train_nll: 0.004450838439977387, valid_nll: 0.04685706061285895, valid_bleu: 0.029513623992811572
calculating bleu for 20 examples...
[2021-09-26 11:54:37] epoch 93: train_loss: 2.3315300746839873, valid_loss: 5.125069073268345, train_nll: 0.004474701199612124, valid_nll: 0.0450786542182329, valid_bleu: 0.02306491755295027
calculating bleu for 20 examples...
[2021-09-26 11:58:04] epoch 94: train_loss: 2.333641634911907, valid_loss: 5.102725914546421, train_nll: 0.004488139071561852, valid_nll: 0.04599590831040503, valid_bleu: 0.029356180172051095
calculating bleu for 20 examples...
[2021-09-26 12:01:32] epoch 95: train_loss: 2.340193064845338, valid_loss: 5.06087589263916, train_nll: 0.004515712514604841, valid_nll: 0.04289946544694208, valid_bleu: 0.05614141024162521
calculating bleu for 20 examples...
[2021-09-26 12:05:00] epoch 96: train_loss: 2.3415409934764004, valid_loss: 5.154304640633719, train_nll: 0.00453662014863929, valid_nll: 0.051295769830511914, valid_bleu: 0.01904847458622018
calculating bleu for 20 examples...
[2021-09-26 12:08:28] epoch 97: train_loss: 2.351044089210277, valid_loss: 5.080333232879639, train_nll: 0.004554954304667556, valid_nll: 0.042249241916763804, valid_bleu: 0.038812310625514296
calculating bleu for 20 examples...
[2021-09-26 12:11:56] epoch 98: train_loss: 2.3498035012459266, valid_loss: 5.072288376944406, train_nll: 0.004566711883846174, valid_nll: 0.044554369351863424, valid_bleu: 0.05440381364554755
calculating bleu for 20 examples...
[2021-09-26 12:15:25] epoch 99: train_loss: 2.3528709557591654, valid_loss: 5.115718705313546, train_nll: 0.004574684940119357, valid_nll: 0.04435024201859006, valid_bleu: 0.0606505405172678
saving at epoch 99...
calculating bleu for 888 examples...
