------------ Configs ------------
building it vocab...
found previously built it vocab, loading...
there are 7426 tokens in it vocab
building en vocab...
found previously built en vocab, loading...
there are 6141 tokens in en vocab
building translation train it->en dataset...
found preprocessed train it->en dataset, loading...
taking 25000 subset of full data...
truncating all sequences to have max 50 tokens...
building it vocab...
found previously built it vocab, loading...
there are 7426 tokens in it vocab
building en vocab...
found previously built en vocab, loading...
there are 6141 tokens in en vocab
building translation valid it->en dataset...
found preprocessed valid it->en dataset, loading...
taking 5000 subset of full data...
truncating all sequences to have max 50 tokens...
model summary: 
=================================================================
                Kernel Shape     Output Shape   Params  Mult-Adds
Layer                                                            
0_src_embedding  [512, 7426]   [128, 50, 512]  3802112    3802112
1_enc                      -   [128, 50, 512]  4202496    4194304
2_tgt_embedding  [512, 6141]   [128, 50, 512]  3144192    3144192
3_dec                      -   [128, 50, 512]  4202496    4194304
4_mlp            [512, 6141]  [128, 50, 6141]  3150333    3144192
-----------------------------------------------------------------
                        Totals
Total params          18501629
Trainable params      18501629
Non-trainable params         0
Mult-Adds             18479104
=================================================================
rnn:  lstm
num layers: 2
embedding dim:  512
data:  iwslt_it_en
max seq tokens:  50
train subset:  25000
valid subset:  5000
optimizer:  sgd
learning rate:  0.1
momentum:  0.9
weight decay:  0.0001
gradient clipping:  1.0
loss criterion:  ce
continue training:  False
save directory:  ./exp/translation/it_en/lstm
log directory:  ./log/translation/it_en/lstm
starting epoch:  0
ending epoch:  100
steps per epoch:  196
cuda:  True
---------------------------------
calculating bleu for 20 examples...
[2021-09-26 06:22:01] epoch 0: train_loss: 6.560247246099978, valid_loss: 5.818447232246399, train_nll: 0.11543577003186266, valid_nll: 0.058801223709564664, valid_bleu: 4.375601476680417e-155
calculating bleu for 20 examples...
[2021-09-26 06:25:29] epoch 1: train_loss: 5.543082548647511, valid_loss: 5.3262845277786255, train_nll: 0.05470662296217315, valid_nll: 0.04918938719548351, valid_bleu: 8.607601211274081e-157
calculating bleu for 20 examples...
[2021-09-26 06:28:57] epoch 2: train_loss: 5.175728021835794, valid_loss: 5.119967043399811, train_nll: 0.047740368689712216, valid_nll: 0.04469643650426289, valid_bleu: 2.7247240779013297e-155
calculating bleu for 20 examples...
[2021-09-26 06:32:25] epoch 3: train_loss: 4.988169837971123, valid_loss: 4.984556317329407, train_nll: 0.04346590829031808, valid_nll: 0.04155452234387568, valid_bleu: 2.7471867630123376e-155
calculating bleu for 20 examples...
[2021-09-26 06:35:54] epoch 4: train_loss: 4.853490121510564, valid_loss: 4.8637096881866455, train_nll: 0.04035951335050622, valid_nll: 0.03937831841316597, valid_bleu: 0.0007561265187215127
calculating bleu for 20 examples...
[2021-09-26 06:39:23] epoch 5: train_loss: 4.719311487917998, valid_loss: 4.742945075035095, train_nll: 0.03772064001589405, valid_nll: 0.03746426865260156, valid_bleu: 5.2206148629875474e-79
calculating bleu for 20 examples...
[2021-09-26 06:42:52] epoch 6: train_loss: 4.595116853713989, valid_loss: 4.66739809513092, train_nll: 0.03547397827148437, valid_nll: 0.035837416627359606, valid_bleu: 5.401599392161828e-79
calculating bleu for 20 examples...
[2021-09-26 06:46:24] epoch 7: train_loss: 4.492738006066303, valid_loss: 4.580147922039032, train_nll: 0.03340741229032399, valid_nll: 0.03430826575065548, valid_bleu: 0.017819864261823366
calculating bleu for 20 examples...
[2021-09-26 06:49:55] epoch 8: train_loss: 4.403982381431424, valid_loss: 4.530145287513733, train_nll: 0.03161934291294643, valid_nll: 0.03342787491161953, valid_bleu: 0.0012085535259051257
calculating bleu for 20 examples...
[2021-09-26 06:53:24] epoch 9: train_loss: 4.319925213346676, valid_loss: 4.460273623466492, train_nll: 0.02997040135597696, valid_nll: 0.032019638147124385, valid_bleu: 0.007994607499472017
saving at epoch 9...
calculating bleu for 20 examples...
[2021-09-26 06:56:56] epoch 10: train_loss: 4.241695343231668, valid_loss: 4.425055205821991, train_nll: 0.02843252073949697, valid_nll: 0.030729397845181704, valid_bleu: 7.184986895488807e-79
calculating bleu for 20 examples...
[2021-09-26 07:00:23] epoch 11: train_loss: 4.166997792769451, valid_loss: 4.384761869907379, train_nll: 0.027000052172830226, valid_nll: 0.030155665026601688, valid_bleu: 0.01413328873311171
calculating bleu for 20 examples...
[2021-09-26 07:03:50] epoch 12: train_loss: 4.101696311211099, valid_loss: 4.351077616214752, train_nll: 0.025711901805644134, valid_nll: 0.029796002561824967, valid_bleu: 0.014128386352314105
calculating bleu for 20 examples...
[2021-09-26 07:07:17] epoch 13: train_loss: 4.0364957962717325, valid_loss: 4.311759769916534, train_nll: 0.024478522693867587, valid_nll: 0.02891595320344404, valid_bleu: 0.017194656088289215
calculating bleu for 20 examples...
[2021-09-26 07:10:45] epoch 14: train_loss: 3.9700547529726613, valid_loss: 4.32461142539978, train_nll: 0.023356548891651386, valid_nll: 0.028687255577395397, valid_bleu: 0.02562792540267255
calculating bleu for 20 examples...
[2021-09-26 07:14:11] epoch 15: train_loss: 3.906399651449554, valid_loss: 4.30157196521759, train_nll: 0.022272623901367188, valid_nll: 0.027927684521677733, valid_bleu: 0.028015091629594896
calculating bleu for 20 examples...
[2021-09-26 07:17:40] epoch 16: train_loss: 3.8460820511895784, valid_loss: 4.290403425693512, train_nll: 0.021264373492805324, valid_nll: 0.027559897939228615, valid_bleu: 0.022269090042872114
calculating bleu for 20 examples...
[2021-09-26 07:21:07] epoch 17: train_loss: 3.7847902276078047, valid_loss: 4.2710612416267395, train_nll: 0.02028903023856027, valid_nll: 0.027310417577281747, valid_bleu: 0.021126865312555417
calculating bleu for 20 examples...
[2021-09-26 07:24:35] epoch 18: train_loss: 3.726966630439369, valid_loss: 4.287366569042206, train_nll: 0.019418362799668486, valid_nll: 0.027526391377321578, valid_bleu: 0.03419714732377282
calculating bleu for 20 examples...
[2021-09-26 07:28:04] epoch 19: train_loss: 3.6678397898771324, valid_loss: 4.284857511520386, train_nll: 0.018550997115154656, valid_nll: 0.027087682560979567, valid_bleu: 0.02870568719931027
saving at epoch 19...
calculating bleu for 20 examples...
[2021-09-26 07:31:33] epoch 20: train_loss: 3.606565217582547, valid_loss: 4.316536843776703, train_nll: 0.017745109757403937, valid_nll: 0.026672171434413586, valid_bleu: 0.021828317708421002
calculating bleu for 20 examples...
[2021-09-26 07:35:01] epoch 21: train_loss: 3.5488075577482885, valid_loss: 4.304265975952148, train_nll: 0.017002594327342753, valid_nll: 0.027214985441393145, valid_bleu: 0.0086393800162565
calculating bleu for 20 examples...
[2021-09-26 07:38:30] epoch 22: train_loss: 3.4935549363798026, valid_loss: 4.334382057189941, train_nll: 0.016346239359330158, valid_nll: 0.026522594767033288, valid_bleu: 0.036388850018845675
calculating bleu for 20 examples...
[2021-09-26 07:41:59] epoch 23: train_loss: 3.4404041256223405, valid_loss: 4.322413265705109, train_nll: 0.015725268209029218, valid_nll: 0.026420949093121374, valid_bleu: 0.0175072356667288
calculating bleu for 20 examples...
[2021-09-26 07:45:30] epoch 24: train_loss: 3.3835758834469076, valid_loss: 4.297752737998962, train_nll: 0.015119717534902145, valid_nll: 0.02611717574077921, valid_bleu: 0.02523564949793606
calculating bleu for 20 examples...
[2021-09-26 07:49:00] epoch 25: train_loss: 3.330465167152638, valid_loss: 4.313502609729767, train_nll: 0.014570690889942403, valid_nll: 0.02627862148349952, valid_bleu: 0.021862926792449933
calculating bleu for 20 examples...
[2021-09-26 07:52:30] epoch 26: train_loss: 3.278972011439654, valid_loss: 4.3442071080207825, train_nll: 0.014058868078115036, valid_nll: 0.02622244191529032, valid_bleu: 0.02720598763042683
calculating bleu for 20 examples...
[2021-09-26 07:55:59] epoch 27: train_loss: 3.2297427763744277, valid_loss: 4.374938011169434, train_nll: 0.013614389637538365, valid_nll: 0.026545742187231446, valid_bleu: 0.02326687015144934
calculating bleu for 20 examples...
[2021-09-26 07:59:29] epoch 28: train_loss: 3.1787478230437456, valid_loss: 4.408000886440277, train_nll: 0.013161805029110032, valid_nll: 0.026996586365007933, valid_bleu: 0.029779041187375253
calculating bleu for 20 examples...
[2021-09-26 08:02:58] epoch 29: train_loss: 3.1338089449065074, valid_loss: 4.450842261314392, train_nll: 0.012739818300519672, valid_nll: 0.02811011424645275, valid_bleu: 0.03319402011006541
saving at epoch 29...
calculating bleu for 20 examples...
[2021-09-26 08:06:27] epoch 30: train_loss: 3.089016538493487, valid_loss: 4.459224760532379, train_nll: 0.012419761442846181, valid_nll: 0.028023254206544848, valid_bleu: 0.03761759340502541
calculating bleu for 20 examples...
[2021-09-26 08:09:54] epoch 31: train_loss: 3.044507622718811, valid_loss: 4.488664031028748, train_nll: 0.012037127683989856, valid_nll: 0.029266506552158598, valid_bleu: 0.04213285540462453
calculating bleu for 20 examples...
[2021-09-26 08:13:22] epoch 32: train_loss: 3.003437986179274, valid_loss: 4.549346029758453, train_nll: 0.01172929957954251, valid_nll: 0.029013590738726402, valid_bleu: 0.03621713114424143
calculating bleu for 20 examples...
[2021-09-26 08:16:50] epoch 33: train_loss: 2.9629418837780856, valid_loss: 4.571830213069916, train_nll: 0.011422043228149414, valid_nll: 0.028862062621439217, valid_bleu: 0.033274906686007945
calculating bleu for 20 examples...
[2021-09-26 08:20:18] epoch 34: train_loss: 2.925684453273306, valid_loss: 4.556734681129456, train_nll: 0.011142026051112584, valid_nll: 0.027949243456784182, valid_bleu: 0.010582542464758465
calculating bleu for 20 examples...
[2021-09-26 08:23:46] epoch 35: train_loss: 2.8881177768415336, valid_loss: 4.635148882865906, train_nll: 0.010880440016765984, valid_nll: 0.032335714202367256, valid_bleu: 0.008502743739266154
calculating bleu for 20 examples...
[2021-09-26 08:27:16] epoch 36: train_loss: 2.8514838303838457, valid_loss: 4.703518569469452, train_nll: 0.010627974814590142, valid_nll: 0.03270285063720408, valid_bleu: 0.03351417666423946
calculating bleu for 20 examples...
[2021-09-26 08:30:45] epoch 37: train_loss: 2.8204331020919646, valid_loss: 4.738679766654968, train_nll: 0.010394331574731944, valid_nll: 0.033520493713519894, valid_bleu: 0.036931796436308235
calculating bleu for 20 examples...
[2021-09-26 08:34:14] epoch 38: train_loss: 2.7879496727670943, valid_loss: 4.685819625854492, train_nll: 0.010184794977927694, valid_nll: 0.033225891831657854, valid_bleu: 0.009653349150192735
calculating bleu for 20 examples...
[2021-09-26 08:37:44] epoch 39: train_loss: 2.756843755439836, valid_loss: 4.738726317882538, train_nll: 0.009983813890729632, valid_nll: 0.034042972039762025, valid_bleu: 0.03170037764627973
saving at epoch 39...
calculating bleu for 20 examples...
[2021-09-26 08:41:14] epoch 40: train_loss: 2.7251171348046284, valid_loss: 4.80146324634552, train_nll: 0.009800491149279536, valid_nll: 0.0360483807576475, valid_bleu: 0.02080200564803891
calculating bleu for 20 examples...
[2021-09-26 08:44:44] epoch 41: train_loss: 2.699804943435046, valid_loss: 4.77614152431488, train_nll: 0.009623767208177217, valid_nll: 0.03409569056012321, valid_bleu: 0.024056005847974044
calculating bleu for 20 examples...
[2021-09-26 08:48:14] epoch 42: train_loss: 2.6728732439936422, valid_loss: 4.801601946353912, train_nll: 0.009440196098794743, valid_nll: 0.03552163782561393, valid_bleu: 0.028764960591690973
calculating bleu for 20 examples...
[2021-09-26 08:51:42] epoch 43: train_loss: 2.6494035270749308, valid_loss: 4.834661900997162, train_nll: 0.009275711277553013, valid_nll: 0.038249250266591574, valid_bleu: 0.021037869528248994
calculating bleu for 20 examples...
[2021-09-26 08:55:10] epoch 44: train_loss: 2.62129222251931, valid_loss: 4.842300236225128, train_nll: 0.009104978552059252, valid_nll: 0.03710833385745732, valid_bleu: 0.03286333731193093
calculating bleu for 20 examples...
[2021-09-26 08:58:34] epoch 45: train_loss: 2.6000760732864845, valid_loss: 4.943053781986237, train_nll: 0.008956631616864885, valid_nll: 0.04522303139700536, valid_bleu: 0.048767585167120056
calculating bleu for 20 examples...
[2021-09-26 09:01:58] epoch 46: train_loss: 2.578640965782866, valid_loss: 4.944305419921875, train_nll: 0.00882849226503956, valid_nll: 0.04265396861717418, valid_bleu: 0.0303956777175552
calculating bleu for 20 examples...
[2021-09-26 09:05:20] epoch 47: train_loss: 2.5589725326518624, valid_loss: 4.97784149646759, train_nll: 0.00870691698969627, valid_nll: 0.044354513661589455, valid_bleu: 0.006991828355195887
calculating bleu for 20 examples...
[2021-09-26 09:08:44] epoch 48: train_loss: 2.538113523502739, valid_loss: 4.971243441104889, train_nll: 0.008598387480802152, valid_nll: 0.04204189152413896, valid_bleu: 0.039491984671802476
calculating bleu for 20 examples...
[2021-09-26 09:12:09] epoch 49: train_loss: 2.5209827240632503, valid_loss: 4.978326439857483, train_nll: 0.008475680870523259, valid_nll: 0.04524287411697416, valid_bleu: 0.04940587439937984
saving at epoch 49...
calculating bleu for 929 examples...
calculating bleu for 20 examples...
[2021-09-26 10:02:48] epoch 50: train_loss: 2.5068155514950656, valid_loss: 4.99197643995285, train_nll: 0.008382057238209005, valid_nll: 0.04613469494882688, valid_bleu: 0.03715592634667354
calculating bleu for 20 examples...
[2021-09-26 10:06:16] epoch 51: train_loss: 2.490452169155588, valid_loss: 5.013249397277832, train_nll: 0.008282656695307518, valid_nll: 0.04441020555614757, valid_bleu: 0.03679878804841617
calculating bleu for 20 examples...
[2021-09-26 10:09:43] epoch 52: train_loss: 2.477887235125717, valid_loss: 5.053317368030548, train_nll: 0.008193623210362025, valid_nll: 0.04578442911859944, valid_bleu: 0.03127454639800088
calculating bleu for 20 examples...
[2021-09-26 10:13:10] epoch 53: train_loss: 2.45870912318327, valid_loss: 5.039174914360046, train_nll: 0.008094286542619978, valid_nll: 0.04863139454542954, valid_bleu: 0.03682291652341298
calculating bleu for 20 examples...
[2021-09-26 10:16:40] epoch 54: train_loss: 2.4474342915476583, valid_loss: 5.0452064871788025, train_nll: 0.008025651340095365, valid_nll: 0.04409573384734903, valid_bleu: 0.02522626281931154
calculating bleu for 20 examples...
[2021-09-26 10:20:06] epoch 55: train_loss: 2.435815926717252, valid_loss: 5.098185300827026, train_nll: 0.00795768981155084, valid_nll: 0.049481566402597696, valid_bleu: 0.040935945205611536
calculating bleu for 20 examples...
[2021-09-26 10:23:33] epoch 56: train_loss: 2.4259530330190855, valid_loss: 5.059257626533508, train_nll: 0.007887292104448591, valid_nll: 0.048793712578621286, valid_bleu: 0.03905347848339915
calculating bleu for 20 examples...
[2021-09-26 10:27:02] epoch 57: train_loss: 2.4153395587084243, valid_loss: 5.094208002090454, train_nll: 0.007827636222060846, valid_nll: 0.047782082306435235, valid_bleu: 0.023891693758059017
calculating bleu for 20 examples...
[2021-09-26 10:30:30] epoch 58: train_loss: 2.4070912295458267, valid_loss: 5.103490769863129, train_nll: 0.007766184692382812, valid_nll: 0.04688132876361666, valid_bleu: 0.037249661112174724
calculating bleu for 20 examples...
[2021-09-26 10:34:00] epoch 59: train_loss: 2.398453082357134, valid_loss: 5.116118431091309, train_nll: 0.007718005289350237, valid_nll: 0.048967618630698456, valid_bleu: 0.03445276101946878
saving at epoch 59...
calculating bleu for 20 examples...
[2021-09-26 10:37:31] epoch 60: train_loss: 2.391910500672399, valid_loss: 5.125248551368713, train_nll: 0.007650030284025231, valid_nll: 0.04821402545862237, valid_bleu: 0.014219264438978908
calculating bleu for 20 examples...
[2021-09-26 10:41:02] epoch 61: train_loss: 2.382698201403326, valid_loss: 5.123145043849945, train_nll: 0.0075922208233268895, valid_nll: 0.05143578424140075, valid_bleu: 0.026385404362283475
calculating bleu for 20 examples...
[2021-09-26 10:44:32] epoch 62: train_loss: 2.372831101320228, valid_loss: 5.16569310426712, train_nll: 0.0075613949437044106, valid_nll: 0.05272139688881432, valid_bleu: 0.021667504955879314
calculating bleu for 20 examples...
[2021-09-26 10:48:02] epoch 63: train_loss: 2.3735564338917636, valid_loss: 5.084826290607452, train_nll: 0.0075412404196602955, valid_nll: 0.04890341346983259, valid_bleu: 0.033184362242511256
calculating bleu for 20 examples...
[2021-09-26 10:51:30] epoch 64: train_loss: 2.3622221545297273, valid_loss: 5.143514335155487, train_nll: 0.007492663371806242, valid_nll: 0.04881212802862206, valid_bleu: 0.024399591738430974
calculating bleu for 20 examples...
[2021-09-26 10:55:00] epoch 65: train_loss: 2.3572828003338406, valid_loss: 5.176734089851379, train_nll: 0.007465614474549585, valid_nll: 0.05383888490521833, valid_bleu: 0.0256868631584026
calculating bleu for 20 examples...
[2021-09-26 10:58:28] epoch 66: train_loss: 2.3553126636816533, valid_loss: 5.194444894790649, train_nll: 0.00744499466831312, valid_nll: 0.05541262196020618, valid_bleu: 0.02703938692444242
calculating bleu for 20 examples...
[2021-09-26 11:01:56] epoch 67: train_loss: 2.352124121724343, valid_loss: 5.154057860374451, train_nll: 0.007409960703168596, valid_nll: 0.04984933947352421, valid_bleu: 0.03986315697740206
calculating bleu for 20 examples...
[2021-09-26 11:05:24] epoch 68: train_loss: 2.3482995884759084, valid_loss: 5.19182413816452, train_nll: 0.007393038630582848, valid_nll: 0.053244389659985236, valid_bleu: 0.036937038476990085
calculating bleu for 20 examples...
[2021-09-26 11:08:53] epoch 69: train_loss: 2.346040594334505, valid_loss: 5.157476365566254, train_nll: 0.007383042494326222, valid_nll: 0.0560692820424701, valid_bleu: 0.03470038911410074
saving at epoch 69...
calculating bleu for 20 examples...
[2021-09-26 11:12:23] epoch 70: train_loss: 2.3439688986661484, valid_loss: 5.1210572719573975, train_nll: 0.007343181155457789, valid_nll: 0.04963934590695597, valid_bleu: 0.02054097703281104
calculating bleu for 20 examples...
[2021-09-26 11:15:53] epoch 71: train_loss: 2.341447731670068, valid_loss: 5.202552676200867, train_nll: 0.007342079799418547, valid_nll: 0.049954266768977816, valid_bleu: 0.030124752972005408
calculating bleu for 20 examples...
[2021-09-26 11:19:23] epoch 72: train_loss: 2.3373837629143073, valid_loss: 5.162705659866333, train_nll: 0.007330656582579321, valid_nll: 0.04996061282062961, valid_bleu: 0.030194395018198143
calculating bleu for 20 examples...
[2021-09-26 11:22:53] epoch 73: train_loss: 2.343088927317639, valid_loss: 5.15427178144455, train_nll: 0.007336592845527493, valid_nll: 0.049509568655534145, valid_bleu: 0.025793354546200485
calculating bleu for 20 examples...
[2021-09-26 11:26:25] epoch 74: train_loss: 2.3389460505271447, valid_loss: 5.205848038196564, train_nll: 0.00731913442417067, valid_nll: 0.0582874488180167, valid_bleu: 0.03353667885916244
calculating bleu for 20 examples...
[2021-09-26 11:29:56] epoch 75: train_loss: 2.3354507429259166, valid_loss: 5.159709393978119, train_nll: 0.007309912590493961, valid_nll: 0.04784148827518073, valid_bleu: 0.0372720207208908
calculating bleu for 20 examples...
[2021-09-26 11:33:25] epoch 76: train_loss: 2.338140546059122, valid_loss: 5.128153026103973, train_nll: 0.007310273544528296, valid_nll: 0.051525404492354, valid_bleu: 0.018442498886915015
calculating bleu for 20 examples...
[2021-09-26 11:36:53] epoch 77: train_loss: 2.337261657325589, valid_loss: 5.190186858177185, train_nll: 0.007323263102161641, valid_nll: 0.05390319555666748, valid_bleu: 0.01922922670869277
calculating bleu for 20 examples...
[2021-09-26 11:40:20] epoch 78: train_loss: 2.3367030900351855, valid_loss: 5.086782693862915, train_nll: 0.007315899834924815, valid_nll: 0.048889893135370406, valid_bleu: 0.04121881349921484
calculating bleu for 20 examples...
[2021-09-26 11:43:48] epoch 79: train_loss: 2.343336978737189, valid_loss: 5.139190137386322, train_nll: 0.007344189679671307, valid_nll: 0.0502640375589042, valid_bleu: 0.02854711017561895
saving at epoch 79...
calculating bleu for 20 examples...
[2021-09-26 11:47:18] epoch 80: train_loss: 2.343246495237156, valid_loss: 5.145700812339783, train_nll: 0.007348143905328244, valid_nll: 0.052653902889071694, valid_bleu: 0.01940611472974425
calculating bleu for 20 examples...
[2021-09-26 11:50:48] epoch 81: train_loss: 2.34300276332972, valid_loss: 5.10057806968689, train_nll: 0.007341854903551997, valid_nll: 0.05005696239729497, valid_bleu: 0.04943476861291889
calculating bleu for 20 examples...
[2021-09-26 11:54:16] epoch 82: train_loss: 2.345434218036885, valid_loss: 5.133241653442383, train_nll: 0.007363555865845284, valid_nll: 0.053458982515277385, valid_bleu: 0.022214375854516716
calculating bleu for 20 examples...
[2021-09-26 11:57:44] epoch 83: train_loss: 2.346297024464121, valid_loss: 5.133761286735535, train_nll: 0.0073750727579545, valid_nll: 0.052804929485495186, valid_bleu: 0.030225003723521687
calculating bleu for 20 examples...
[2021-09-26 12:01:12] epoch 84: train_loss: 2.3507151433399747, valid_loss: 5.106857657432556, train_nll: 0.007386256536366988, valid_nll: 0.047880478333278194, valid_bleu: 0.021763280910268905
calculating bleu for 20 examples...
[2021-09-26 12:04:41] epoch 85: train_loss: 2.3525800741448695, valid_loss: 5.117994546890259, train_nll: 0.007400719459689393, valid_nll: 0.04931561444120666, valid_bleu: 0.0185062343321487
calculating bleu for 20 examples...
[2021-09-26 12:08:10] epoch 86: train_loss: 2.351081197359124, valid_loss: 5.114605724811554, train_nll: 0.007406108557253468, valid_nll: 0.05230972781824916, valid_bleu: 0.017202215072663403
calculating bleu for 20 examples...
[2021-09-26 12:11:40] epoch 87: train_loss: 2.3592399845317917, valid_loss: 5.13606470823288, train_nll: 0.007443351862400984, valid_nll: 0.052263531167178565, valid_bleu: 0.029303198409047788
calculating bleu for 20 examples...
[2021-09-26 12:15:11] epoch 88: train_loss: 2.3616777098908717, valid_loss: 5.0944695472717285, train_nll: 0.007456248651621293, valid_nll: 0.05248292094868358, valid_bleu: 0.031245807347298392
calculating bleu for 20 examples...
[2021-09-26 12:18:44] epoch 89: train_loss: 2.3641308059497756, valid_loss: 5.119181931018829, train_nll: 0.007479934004180285, valid_nll: 0.05193757474809285, valid_bleu: 0.04009016558171312
saving at epoch 89...
calculating bleu for 20 examples...
[2021-09-26 12:22:15] epoch 90: train_loss: 2.3701262960628586, valid_loss: 5.067987382411957, train_nll: 0.00749742438102255, valid_nll: 0.045471321066513457, valid_bleu: 0.029777940342771307
calculating bleu for 20 examples...
[2021-09-26 12:25:45] epoch 91: train_loss: 2.3681801776496734, valid_loss: 5.059627175331116, train_nll: 0.007498255590322066, valid_nll: 0.048519593074027756, valid_bleu: 0.03129460791564634
calculating bleu for 20 examples...
[2021-09-26 12:29:13] epoch 92: train_loss: 2.3720291561009934, valid_loss: 5.107300162315369, train_nll: 0.007531087675289232, valid_nll: 0.04914627939597069, valid_bleu: 0.02118824147615931
calculating bleu for 20 examples...
[2021-09-26 12:32:42] epoch 93: train_loss: 2.372316607407161, valid_loss: 5.037307620048523, train_nll: 0.007548016286577497, valid_nll: 0.043811945547536715, valid_bleu: 0.0535537059680329
calculating bleu for 20 examples...
[2021-09-26 12:36:10] epoch 94: train_loss: 2.3833158709564986, valid_loss: 5.046981513500214, train_nll: 0.007595107495833416, valid_nll: 0.04656832041146141, valid_bleu: 0.04214857288121665
calculating bleu for 20 examples...
[2021-09-26 12:39:39] epoch 95: train_loss: 2.3847125415899315, valid_loss: 5.079763412475586, train_nll: 0.007602897735907107, valid_nll: 0.04855551836632513, valid_bleu: 0.0145797836623112
calculating bleu for 20 examples...
[2021-09-26 12:43:09] epoch 96: train_loss: 2.3856512855510323, valid_loss: 5.064997971057892, train_nll: 0.007632873442317665, valid_nll: 0.048053502947331364, valid_bleu: 0.023698444496697273
calculating bleu for 20 examples...
[2021-09-26 12:46:39] epoch 97: train_loss: 2.3921089756245517, valid_loss: 5.031219244003296, train_nll: 0.007665665702041314, valid_nll: 0.050032056297173846, valid_bleu: 0.020902029021340796
calculating bleu for 20 examples...
[2021-09-26 12:50:06] epoch 98: train_loss: 2.393943096910204, valid_loss: 5.024299263954163, train_nll: 0.007696973092333762, valid_nll: 0.04616259884459261, valid_bleu: 0.03752768537520318
calculating bleu for 20 examples...
[2021-09-26 12:53:29] epoch 99: train_loss: 2.399435061581281, valid_loss: 5.008697748184204, train_nll: 0.00771456120627267, valid_nll: 0.042347369174623686, valid_bleu: 0.021126865312555417
saving at epoch 99...
calculating bleu for 929 examples...
